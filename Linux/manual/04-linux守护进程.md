# Linux 守护进程

守护进程英文名叫做 `daemon`，一直在后台运行的进程，我们就称它为 `守护进程`。

> 提示：拿 Windows 来对比，加入系统服务(service)的程序功能就与 Linux 下的守护进程差不多了！

## 一、问题的由来

Web 应用写好后，下一件事就是启动，让它一直在后台运行。但是这并不容易。举例来说：

1. 下面是一个最简单的 Node 应用 server.js，只有 6 行：

   ```js
   var http = require("http");

   http
     .createServer(function(req, res) {
       res.writeHead(200, { "Content-Type": "text/plain" });
       res.end("Hello World");
     })
     .listen(5000);
   ```

2. 在命令行下启动它：

   ```sh
   $ node server.js
   ```

   看上去一切正常，所有人都能快乐地访问 5000 端口了。但是，一旦你退出命令行窗口，这个应用就一起退出了，无法访问了。

   > 怎么才能让它变成系统的守护进程（daemon），成为一种服务（service），一直在那里运行呢？

## 二、前台任务与后台任务

| 概念                     | 描述                                                       |
| ------------------------ | ---------------------------------------------------------- |
| 前台任务(foreground job) | 独占命令行窗口，只有运行完了或者手动中止，才能执行其他命令 |
| 后台任务(background job) | 应用程序关闭之后依然可以继续运行相关的服务                 |

> 变成守护进程的第一步，就是把它改成"后台任务"。

1. 改成后台任务

   只要在命令的尾部加上符号`&`，启动的进程就会成为"后台任务"。

   ```sh
   $ node server.js &
   ```

   如果要让正在运行的"前台任务"变为"后台任务"，可以先按 `ctrl + z`，然后执行 `bg` 命令（让最近一个暂停的"后台任务"继续执行）。
